<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2 Knowledge Check Quiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #11998e;
        }

        h1 {
            color: #11998e;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1rem;
        }

        .instructions {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #4caf50;
        }

        .instructions h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .question-container {
            margin-bottom: 35px;
            padding: 25px;
            background: #f9f9f9;
            border-radius: 10px;
            border-left: 5px solid #11998e;
            display: none;
        }

        .question-container.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .question-number {
            color: #11998e;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.15rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .options {
            margin-left: 10px;
        }

        .option {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: flex-start;
        }

        .option:hover {
            border-color: #11998e;
            background: #f0fdf4;
            transform: translateX(5px);
        }

        .option input[type="radio"] {
            margin-right: 12px;
            margin-top: 3px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .option label {
            cursor: pointer;
            flex: 1;
            font-size: 1rem;
        }

        .option.selected {
            border-color: #11998e;
            background: #f0fdf4;
        }

        .option.correct {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .option.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .feedback.correct {
            background: #c8e6c9;
            border-left: 5px solid #4caf50;
            color: #2e7d32;
        }

        .feedback.incorrect {
            background: #ffcdd2;
            border-left: 5px solid #f44336;
            color: #c62828;
        }

        .feedback h4 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }

        .btn-primary {
            background: #11998e;
            color: white;
        }

        .btn-primary:hover {
            background: #0d7a6f;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(17, 153, 142, 0.4);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        .quiz-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .quiz-info-item {
            text-align: center;
        }

        .quiz-info-label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .quiz-info-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #11998e;
        }

        .results-container {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .results-container.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .score-display {
            font-size: 4rem;
            font-weight: bold;
            color: #11998e;
            margin: 20px 0;
        }

        .score-message {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .performance-badge {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 20px 0;
        }

        .badge-excellent {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .badge-good {
            background: #b3e5fc;
            color: #01579b;
        }

        .badge-fair {
            background: #fff9c4;
            color: #f57f17;
        }

        .badge-needs-review {
            background: #ffcdd2;
            color: #c62828;
        }

        .review-section {
            margin-top: 30px;
            padding: 25px;
            background: #f9f9f9;
            border-radius: 10px;
            text-align: left;
        }

        .review-item {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 5px solid #ddd;
        }

        .review-item.correct {
            border-left-color: #4caf50;
        }

        .review-item.incorrect {
            border-left-color: #f44336;
        }

        .review-question {
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .review-answer {
            margin-top: 8px;
            font-size: 0.95rem;
        }

        .review-answer.user {
            color: #666;
        }

        .review-answer.correct-ans {
            color: #2e7d32;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .buttons {
                flex-direction: column;
            }

            .quiz-info {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Module 2 Knowledge Check</h1>
            <p class="subtitle">Multilevel Modeling Fundamentals</p>
        </header>

        <div class="instructions">
            <h3>üìã Instructions</h3>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li>This quiz has <strong>10 multiple-choice questions</strong></li>
                <li>Focus on ICC, random effects, model building, and interpretation</li>
                <li>Select your answer by clicking on it</li>
                <li>Click "Submit Answer" to see if you're correct</li>
                <li>You'll receive immediate feedback and explanations</li>
                <li>You need <strong>80% (8/10)</strong> to pass</li>
                <li>Take your time and think carefully!</li>
            </ul>
        </div>

        <div class="quiz-info">
            <div class="quiz-info-item">
                <div class="quiz-info-label">Question</div>
                <div class="quiz-info-value"><span id="currentQuestion">1</span> / 10</div>
            </div>
            <div class="quiz-info-item">
                <div class="quiz-info-label">Score</div>
                <div class="quiz-info-value"><span id="currentScore">0</span> / 10</div>
            </div>
            <div class="quiz-info-item">
                <div class="quiz-info-label">Percentage</div>
                <div class="quiz-info-value"><span id="percentage">0</span>%</div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <div id="quizContainer"></div>

        <div class="results-container" id="resultsContainer">
            <h2>üéâ Quiz Complete!</h2>
            <div class="score-display" id="finalScore">0/10</div>
            <div class="score-message" id="scoreMessage"></div>
            <div class="performance-badge" id="performanceBadge"></div>
            
            <div class="review-section">
                <h3 style="margin-bottom: 20px; color: #11998e;">üìù Review Your Answers</h3>
                <div id="reviewContent"></div>
            </div>

            <div class="buttons" style="margin-top: 30px;">
                <button class="btn btn-primary" onclick="retakeQuiz()">üîÑ Retake Quiz</button>
                <button class="btn btn-secondary" onclick="window.location.href='advanced_research_training.html#module3'">Continue to Module 3 ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        const quizQuestions = [
            {
                question: "How do you calculate the Intraclass Correlation (ICC)?",
                options: [
                    "ICC = œÉ¬≤ / (œÑ‚ÇÄ‚ÇÄ + œÉ¬≤)",
                    "ICC = œÑ‚ÇÄ‚ÇÄ / (œÑ‚ÇÄ‚ÇÄ + œÉ¬≤)",
                    "ICC = (œÑ‚ÇÄ‚ÇÄ + œÉ¬≤) / œÑ‚ÇÄ‚ÇÄ",
                    "ICC = œÑ‚ÇÄ‚ÇÄ √ó œÉ¬≤"
                ],
                correct: 1,
                explanation: "ICC = œÑ‚ÇÄ‚ÇÄ / (œÑ‚ÇÄ‚ÇÄ + œÉ¬≤), where œÑ‚ÇÄ‚ÇÄ is between-group variance and œÉ¬≤ is within-group variance. The ICC represents the proportion of total variance that exists between groups. For example, if œÑ‚ÇÄ‚ÇÄ = 20 and œÉ¬≤ = 80, then ICC = 20/(20+80) = 0.20, meaning 20% of variance is between groups."
            },
            {
                question: "What does it mean when we say an intercept is 'random' in a multilevel model?",
                options: [
                    "The intercept varies randomly with no pattern",
                    "Each group has its own intercept that can differ from the overall mean",
                    "The intercept is calculated using a random number generator",
                    "The intercept is unreliable and shouldn't be interpreted"
                ],
                correct: 1,
                explanation: "A random intercept means each Level-2 unit (e.g., school) has its own baseline that differs from the grand mean. For example, if the grand mean achievement is 75 points, School A might have an intercept of 80 (5 points above average) and School B might have 70 (5 points below). This variation is modeled as u‚ÇÄj ~ N(0, œÑ‚ÇÄ‚ÇÄ), meaning school deviations are normally distributed around the grand mean."
            },
            {
                question: "In a multilevel model, what is the difference between fixed effects and random effects?",
                options: [
                    "Fixed effects stay the same over time; random effects change",
                    "Fixed effects are average relationships across all groups; random effects capture how those relationships vary by group",
                    "Fixed effects are more important than random effects",
                    "Fixed effects use larger sample sizes than random effects"
                ],
                correct: 1,
                explanation: "Fixed effects (Œ≥) represent average effects across all Level-2 units. For example, Œ≥‚ÇÅ‚ÇÄ = 0.5 means on average, a one-unit increase in X relates to a 0.5-unit increase in Y. Random effects (œÑ, u) capture how much this relationship varies by group. If we allow random slopes (u‚ÇÅj), some schools might have a slope of 0.3, others 0.7, showing the relationship differs by context."
            },
            {
                question: "Why is centering variables important in multilevel modeling?",
                options: [
                    "It makes the numbers smaller and easier to work with",
                    "It affects the interpretation of the intercept and can separate within-group from between-group effects",
                    "It's required by statistical software",
                    "It increases statistical power"
                ],
                correct: 1,
                explanation: "Centering changes what the intercept represents and can separate effects. Grand-mean centering (subtract overall mean) makes the intercept = expected Y when X is at its average. Group-mean centering (subtract group mean) separates within-group effects from between-group effects‚Äîcrucial when the relationship within groups differs from between groups. For example, individual SES vs. school average SES may have different effects."
            },
            {
                question: "In model building, what is the purpose of starting with a null model (unconditional model)?",
                options: [
                    "To test whether your outcome variable is normally distributed",
                    "To partition variance and calculate ICC to see if multilevel modeling is justified",
                    "To identify outliers in your data",
                    "To check whether your sample size is adequate"
                ],
                correct: 1,
                explanation: "The null model (no predictors, only outcome) partitions total variance into between-group (œÑ‚ÇÄ‚ÇÄ) and within-group (œÉ¬≤) components. This lets you calculate ICC and determine if clustering is meaningful. If ICC > .05, multilevel modeling is typically warranted. The null model also provides a baseline for calculating how much variance predictors explain (pseudo R¬≤)."
            },
            {
                question: "What does it mean to test for 'random slopes' in a multilevel model?",
                options: [
                    "Testing whether the slopes are calculated correctly",
                    "Testing whether the relationship between a predictor and outcome varies significantly across Level-2 units",
                    "Testing whether slopes are statistically significant",
                    "Testing whether slopes need to be centered"
                ],
                correct: 1,
                explanation: "Random slopes test whether a relationship varies by context. For example: Does the effect of homework on achievement differ by school? If YES (significant variance in slopes), then œÑ‚ÇÅ‚ÇÅ > 0 and we keep random slopes. This allows us to examine which school characteristics explain why homework helps more in some schools than others (cross-level interactions). If NO, we fix the slope (constraint it equal across schools)."
            },
            {
                question: "What is a cross-level interaction in multilevel modeling?",
                options: [
                    "When two Level-1 predictors interact with each other",
                    "When a Level-2 variable moderates the relationship between a Level-1 predictor and the outcome",
                    "When variables from different time points interact",
                    "When two Level-2 predictors are correlated"
                ],
                correct: 1,
                explanation: "Cross-level interactions occur when a group-level variable affects an individual-level relationship. Example: Does school poverty (Level 2) moderate the effect of individual SES (Level 1) on achievement? If Œ≥‚ÇÅ‚ÇÅ is significant in Œ≤‚ÇÅj = Œ≥‚ÇÅ‚ÇÄ + Œ≥‚ÇÅ‚ÇÅ(SchoolPoverty) + u‚ÇÅj, then the SES effect differs based on school poverty. This is powerful for understanding context effects‚Äîindividual characteristics may matter more or less depending on organizational context."
            },
            {
                question: "If œÑ‚ÇÄ‚ÇÄ (between-group variance in intercepts) is NOT significant, what does this suggest?",
                options: [
                    "Your model is incorrect and needs to be rebuilt",
                    "Groups don't differ significantly on the outcome after controlling for predictors",
                    "You need a larger sample size",
                    "You should switch to regular regression"
                ],
                correct: 1,
                explanation: "Non-significant œÑ‚ÇÄ‚ÇÄ means that after accounting for your predictors, schools don't differ much in their average outcome levels. This could mean: (1) your Level-1 and Level-2 predictors explain most between-school variance, or (2) schools are truly similar on this outcome. However, you should still use MLM if data is nested because even small remaining clustering can bias standard errors. The ICC might be small, but dependency still exists."
            },
            {
                question: "What does 'deviance' measure in multilevel model comparison?",
                options: [
                    "How far your data deviates from normality",
                    "Model fit, with lower deviance indicating better fit (-2 √ó log likelihood)",
                    "The standard deviation of residuals",
                    "The degree of multicollinearity in your predictors"
                ],
                correct: 1,
                explanation: "Deviance = -2 √ó log likelihood. Lower deviance = better fit. When comparing nested models (one is a simpler version of another), you can use a likelihood ratio test: Œî deviance follows a œá¬≤ distribution with df = difference in parameters. If Œî deviance is significant, the more complex model fits significantly better. You can also use AIC (deviance + 2k) and BIC (deviance + k√óln(n)) where lower values indicate better balance of fit and parsimony."
            },
            {
                question: "What is the main advantage of multilevel modeling over aggregating to group level or disaggregating to individual level?",
                options: [
                    "It's easier to compute and interpret",
                    "It simultaneously models variation at multiple levels, avoiding ecological fallacy and preserving individual-level variation",
                    "It requires smaller sample sizes",
                    "It always produces significant results"
                ],
                correct: 1,
                explanation: "Aggregating (analyzing only school means) loses individual variation and commits the ecological fallacy‚Äîrelationships at group level may not reflect individual-level processes. Disaggregating (treating all students as independent) ignores clustering and produces biased standard errors. MLM does both: it models individual variation WHILE accounting for group membership, examines relationships at each level separately, and tests cross-level interactions. You get the full picture."
            }
        ];

        // Quiz State
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = [];

        function initQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = [];
            document.getElementById('resultsContainer').classList.remove('show');
            renderQuestion();
            updateProgress();
        }

        function renderQuestion() {
            const container = document.getElementById('quizContainer');
            const question = quizQuestions[currentQuestionIndex];
            
            container.innerHTML = `
                <div class="question-container active">
                    <div class="question-number">Question ${currentQuestionIndex + 1} of 10</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options" id="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectOption(${index})">
                                <input type="radio" name="answer" id="option${index}" value="${index}">
                                <label for="option${index}">${option}</label>
                            </div>
                        `).join('')}
                    </div>
                    <div class="feedback" id="feedback"></div>
                    <div class="buttons">
                        <button class="btn btn-secondary" onclick="previousQuestion()" ${currentQuestionIndex === 0 ? 'style="visibility: hidden;"' : ''}>
                            ‚Üê Previous
                        </button>
                        <button class="btn btn-primary" id="submitBtn" onclick="submitAnswer()">
                            Submit Answer
                        </button>
                        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                            Next ‚Üí
                        </button>
                    </div>
                </div>
            `;

            if (userAnswers[currentQuestionIndex] !== undefined) {
                selectOption(userAnswers[currentQuestionIndex].selected);
                showFeedback(userAnswers[currentQuestionIndex].selected === question.correct);
            }

            updateProgress();
        }

        function selectOption(index) {
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            document.querySelectorAll('.option')[index].classList.add('selected');
            document.getElementById(`option${index}`).checked = true;
        }

        function submitAnswer() {
            const selected = document.querySelector('input[name="answer"]:checked');
            
            if (!selected) {
                alert('Please select an answer before submitting.');
                return;
            }

            const selectedIndex = parseInt(selected.value);
            const question = quizQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === question.correct;

            if (userAnswers[currentQuestionIndex] === undefined) {
                userAnswers[currentQuestionIndex] = {
                    selected: selectedIndex,
                    correct: isCorrect
                };
                
                if (isCorrect) {
                    score++;
                }
            }

            showFeedback(isCorrect);
            updateProgress();
        }

        function showFeedback(isCorrect) {
            const question = quizQuestions[currentQuestionIndex];
            const feedback = document.getElementById('feedback');
            const submitBtn = document.getElementById('submitBtn');
            const nextBtn = document.getElementById('nextBtn');
            const options = document.querySelectorAll('.option');

            options.forEach((opt, index) => {
                opt.style.pointerEvents = 'none';
                if (index === question.correct) {
                    opt.classList.add('correct');
                } else if (index === parseInt(document.querySelector('input[name="answer"]:checked').value) && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            feedback.className = 'feedback show ' + (isCorrect ? 'correct' : 'incorrect');
            feedback.innerHTML = `
                <h4>${isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect'}</h4>
                <p><strong>Explanation:</strong> ${question.explanation}</p>
            `;

            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
            nextBtn.textContent = currentQuestionIndex === 9 ? 'View Results ‚Üí' : 'Next ‚Üí';
        }

        function nextQuestion() {
            if (currentQuestionIndex < 9) {
                currentQuestionIndex++;
                renderQuestion();
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / 10) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('currentScore').textContent = score;
            document.getElementById('percentage').textContent = Math.round((score / 10) * 100);
        }

        function showResults() {
            document.getElementById('quizContainer').style.display = 'none';
            const resultsContainer = document.getElementById('resultsContainer');
            resultsContainer.classList.add('show');

            const percentage = (score / 10) * 100;
            
            document.getElementById('finalScore').textContent = `${score}/10`;
            
            let message, badge, badgeClass;
            if (percentage >= 90) {
                message = "Excellent! You have mastered multilevel modeling concepts.";
                badge = "üåü Excellent";
                badgeClass = "badge-excellent";
            } else if (percentage >= 80) {
                message = "Great job! You understand multilevel modeling well.";
                badge = "‚úÖ Passed";
                badgeClass = "badge-good";
            } else if (percentage >= 70) {
                message = "Good effort! Review ICC, random effects, and model building.";
                badge = "üìö Good";
                badgeClass = "badge-fair";
            } else {
                message = "Review Module 2 content, especially variance partitioning and model specification.";
                badge = "üìñ Needs Review";
                badgeClass = "badge-needs-review";
            }

            document.getElementById('scoreMessage').textContent = message;
            const badgeElement = document.getElementById('performanceBadge');
            badgeElement.textContent = badge;
            badgeElement.className = 'performance-badge ' + badgeClass;

            generateReview();
        }

        function generateReview() {
            const reviewContent = document.getElementById('reviewContent');
            let html = '';

            quizQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer && userAnswer.correct;
                
                html += `
                    <div class="review-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <div class="review-question">
                            <strong>Question ${index + 1}:</strong> ${question.question}
                        </div>
                        <div class="review-answer user">
                            <strong>Your answer:</strong> ${question.options[userAnswer.selected]}
                            ${isCorrect ? '‚úÖ' : '‚ùå'}
                        </div>
                        ${!isCorrect ? `
                            <div class="review-answer correct-ans">
                                <strong>Correct answer:</strong> ${question.options[question.correct]}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            reviewContent.innerHTML = html;
        }

        function retakeQuiz() {
            document.getElementById('quizContainer').style.display = 'block';
            initQuiz();
        }

        window.onload = initQuiz;
    </script>
</body>
</html>